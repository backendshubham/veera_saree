<!-- Full Page Loader -->
<div id="pageLoader" class="page-loader">
    <div class="loader-content">
        <div class="loader-spinner">
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
            <div class="spinner-ring"></div>
        </div>
        <div class="loader-text">Loading...</div>
    </div>
</div>

<style>
    .page-loader {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.75);
        backdrop-filter: blur(4px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.2s ease, visibility 0.2s ease;
    }
    
    .page-loader.active {
        opacity: 1;
        visibility: visible;
    }
    
    .loader-content {
        text-align: center;
    }
    
    .loader-spinner {
        position: relative;
        width: 50px;
        height: 50px;
        margin: 0 auto 15px;
    }
    
    .spinner-ring {
        position: absolute;
        width: 100%;
        height: 100%;
        border: 3px solid transparent;
        border-top-color: white;
        border-radius: 50%;
        animation: spin 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;
    }
    
    .spinner-ring:nth-child(1) {
        animation-delay: -0.45s;
    }
    
    .spinner-ring:nth-child(2) {
        animation-delay: -0.3s;
        border-top-color: rgba(255,255,255,0.8);
    }
    
    .spinner-ring:nth-child(3) {
        animation-delay: -0.15s;
        border-top-color: rgba(255,255,255,0.6);
    }
    
    .spinner-ring:nth-child(4) {
        border-top-color: rgba(255,255,255,0.4);
    }
    
    @keyframes spin {
        0% {
            transform: rotate(0deg);
        }
        100% {
            transform: rotate(360deg);
        }
    }
    
    .loader-text {
        color: white;
        font-size: 0.9rem;
        font-weight: 500;
        letter-spacing: 1px;
        text-transform: uppercase;
        animation: pulse 1.5s ease-in-out infinite;
        opacity: 0.9;
    }
    
    @keyframes pulse {
        0%, 100% {
            opacity: 1;
        }
        50% {
            opacity: 0.5;
        }
    }
    
    /* Alternative loader style - bars */
    .loader-bars {
        display: flex;
        gap: 6px;
        justify-content: center;
        align-items: center;
        margin-bottom: 15px;
    }
    
    .loader-bar {
        width: 5px;
        height: 25px;
        background: white;
        border-radius: 3px;
        animation: bar-bounce 1.4s ease-in-out infinite;
    }
    
    .loader-bar:nth-child(1) {
        animation-delay: 0s;
    }
    
    .loader-bar:nth-child(2) {
        animation-delay: 0.1s;
    }
    
    .loader-bar:nth-child(3) {
        animation-delay: 0.2s;
    }
    
    .loader-bar:nth-child(4) {
        animation-delay: 0.3s;
    }
    
    @keyframes bar-bounce {
        0%, 40%, 100% {
            transform: scaleY(0.4);
            opacity: 0.5;
        }
        20% {
            transform: scaleY(1);
            opacity: 1;
        }
    }
</style>

<script>
    // Page Loader Functions
    let loaderShown = false;
    
    function showLoader() {
        const loader = document.getElementById('pageLoader');
        if (loader) {
            loader.classList.add('active');
            loaderShown = true;
        }
    }
    
    function hideLoader() {
        const loader = document.getElementById('pageLoader');
        if (loader) {
            loader.classList.remove('active');
            loaderShown = false;
        }
    }
    
    // Hide loader as soon as DOM is ready (much faster)
    if (document.readyState === 'loading') {
        // Only show loader if page takes time to load
        const loadStartTime = Date.now();
        document.addEventListener('DOMContentLoaded', function() {
            const loadTime = Date.now() - loadStartTime;
            // If page loaded quickly (< 200ms), don't show loader at all
            if (loadTime < 200) {
                hideLoader();
            } else {
                // Hide loader quickly after DOM is ready
                setTimeout(function() {
                    hideLoader();
                }, 100);
            }
        });
    } else {
        // DOM is already ready, hide immediately
        hideLoader();
    }
    
    // Also hide on window load as backup (but with shorter delay)
    window.addEventListener('load', function() {
        setTimeout(function() {
            hideLoader();
        }, 50);
    });
    
    // Show loader on form submissions (only for actual submissions)
    document.addEventListener('DOMContentLoaded', function() {
        // Handle form submissions
        const forms = document.querySelectorAll('form');
        forms.forEach(function(form) {
            form.addEventListener('submit', function(e) {
                // Only show loader if form is actually submitting (not prevented)
                const formData = new FormData(form);
                if (formData) {
                    showLoader();
                }
            });
        });
        
        // Only show loader for navigation links (not all links)
        const navLinks = document.querySelectorAll('a[href^="/"]:not(.no-loader):not([href^="#"]):not([href^="javascript:"])');
        navLinks.forEach(function(link) {
            link.addEventListener('click', function(e) {
                // Only show loader for actual navigation
                const href = link.getAttribute('href');
                if (href && (href.startsWith('/') || href.startsWith(window.location.origin))) {
                    // Small delay to ensure navigation is happening
                    setTimeout(function() {
                        showLoader();
                    }, 50);
                }
            });
        });
        
        // Handle navigation events
        window.addEventListener('beforeunload', function() {
            showLoader();
        });
    });
    
    // Hide loader immediately on page visibility change (back button, etc.)
    document.addEventListener('visibilitychange', function() {
        if (!document.hidden) {
            // Hide immediately when page becomes visible
            setTimeout(function() {
                hideLoader();
            }, 100);
        }
    });
</script>

